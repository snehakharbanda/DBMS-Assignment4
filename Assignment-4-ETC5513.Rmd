---
title: "Collab-assignment-4"
author: "Rohan Baghel"
date: '2022-05-20'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  eval = TRUE,
  message = FALSE,  # Change this to FALSE before you submit your assignment
  warning = FALSE,  # Change this to FALSE before you submit your assignment
  error = FALSE,    # Change this to FALSE before you submit your assignment
  out.width = "80%",
  fig.width = 8, 
  fig.height = 6,
  fig.retina = 3)
set.seed(6)
```

```{r}
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
```

```{r read_data}
La_liga_data <- read.csv("data/laliga_player_stats_english.csv")
```

\section*{Defender}

The motive of this section is to find out the **best defender** in Laliga (Spanish football league), season 2019-2020 according to player stats. We will be analyzing different variables to get the best defender out of the 20 teams. 

```{r}
defender <- La_liga_data %>%
  filter(Position == "Defender") %>%
  select(Team, Name, Games.played, Yellow.Cards, Goals.conceded.while.player.on.pitch,
         Interceptions, Recoveries, Clearances, Successful.tackles, Unssuccessful.tackles,
         Fouls.committed, Successful.duels, Duels.lost, Successful.aerial.challenges,
         Unsuccessful.aerial.challenges, Fouls.committed.per.card )
```

We will try to find the best defender by going through different levels, the major one being, trying to find the player who has the most recoveries and clearances. 

* Recovery  - A recovery is recorded at the point where the player of the team beginning the possession touches the ball. 

* Clearance - When a player kicks the ball away from the goal they are defending. 

```{r}
defender1 <- defender %>%
  filter(Games.played >= 19)
ggplot(defender1,
       aes(x = Clearances,
           y = Recoveries,
           colour = Team, 
           label = Name)) +
  theme_minimal() +
  geom_text(size = 5) +
  theme_gray(base_size = 15) +
  geom_point() +
  labs(y = "Number of clearances",
       x = "Number of Recoveries",
       title = "Clearances Vs.Recoveries")
  
  
```



# Section-2

# Section-3

# Section-4

