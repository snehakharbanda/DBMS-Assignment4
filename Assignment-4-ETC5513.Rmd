---
title: "Collab-assignment-4"
author: "Rohan Baghel"
date: '2022-05-20'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  eval = TRUE,
  message = FALSE,  # Change this to FALSE before you submit your assignment
  warning = FALSE,  # Change this to FALSE before you submit your assignment
  error = FALSE,    # Change this to FALSE before you submit your assignment
  out.width = "80%",
  fig.width = 8, 
  fig.height = 6,
  fig.retina = 3)
set.seed(6)
```

```{r}
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
```

```{r read_data}
La_liga_data <- read.csv("data/laliga_player_stats_english.csv")
```

# Section-1 

# Section-2

# Section-3

# Position : Goalkeeper

## Question:

__- Which football team's goalkeeper has the best performance in La-Liga in the season 2019 - 2020 ?__

```{r}
goal_data <- La_liga_data %>%
  filter(Position == "Goalkeeper") %>%
  select(Team, Position, Name, Games.played, Goals.conceded.while.player.on.pitch, Recoveries, Clearances) %>%
  rename("Game_played" = Games.played,
         "Goal_conceded" = Goals.conceded.while.player.on.pitch)
```

```{r graph, echo = FALSE, message = FALSE, warning = FALSE}
p2 <- ggplot(mean_goal_data, 
             aes(x = Name, 
                 y = Recoveries, label = Name)) +
  geom_point() +
  geom_text(hjust = 0.5, vjust = -1) + 
  theme(axis.text.x=element_blank(),
        axis.ticks = element_blank())

p3 <- ggplot(mean_goal_data, 
             aes(x = Name, 
                 y = Clearances, label = Name)) +
  geom_point() +
  geom_text(hjust = 0.5, vjust = -1) + 
  theme(axis.text.x=element_blank(),
        axis.ticks = element_blank())

gridExtra::grid.arrange(p2, p3, ncol = 2)
```

In Figure \@ref(fig:graph), it shows the data of Recoveries and Clearances for each goalkeeper in La-Liga during the season 2019 to 2020.

```{r scatterplot}
ggplot(goal_data, 
       aes(x = Recoveries,
           y = Clearances)) +
  geom_point() +
  theme_bw()
```

In Figure \@ref(fig: scatterplot), it displays a scatter plot for goalkeepers' Recoveries and Clearances, it demonstrates there is a positive relationship between variable Clearances and Recoveries.

```{r goal-data1, echo = FALSE, message = FALSE, warning = FALSE}
goal_data2 <- goal_data %>%
  select(Team, Name, Recoveries) %>%
  arrange(desc(Recoveries)) %>%
  mutate("Rank_recoveries" = 1:n())

goal_data3 <- goal_data %>%
  select(Name, Clearances) %>%
  arrange(desc(Clearances)) %>%
  mutate("Rank_clearances" = 1:n())

goal_data4 <- goal_data2 %>%
  left_join(goal_data3, by = "Name") %>%
  mutate("Average" = (Rank_recoveries + Rank_clearances)/2) %>%
  arrange(Average) %>%
  head(10) %>%
  select(Team, Name, Recoveries, Clearances) %>%
  mutate("Rank" = 1:n())

knitr::kable(goal_data4, caption = "Top 10 Goalkeepers" , "pipe", align = "llccr")
```

In Table \@ref(tab:goal-data1), it shows the football recoveries and clearances of top 10 goalkeepers in in La-Liga during the season 2019 to 2020.

In this section, the data of goalkeeper has been using to investigate and in a aim to find which goalkeeper is overall performing best in La-Liga during the season 2019 to 2020. The Figure \@ref(fig:graph) shows the performance of each single goalkeeper in term of Recoveries and Clearances during the season. In the Figure \@ref(fig: scatterplot), it demonstrates that there is a linear relationship between Recoveries and Clearances, on other words, a goalkeeper tends to have a good performance in term of Recoveries also performing well in term of Clearances. Based on the observation in the scatter plot, Recoveries and Clearances are two standard variables sharing some similarity. Hence, we can rank each variable Recoveries and Clearance and combine the ranks to find the average performance on both Recoveries and Clearances, and then the top 10 goalkeepers are listed out based on the average rank of performance. As displayed on Table \@ref(tab:goal-data1), the goalkeeper David Soria, from football team Getafe CF, is performing best among all goalkeepers in La-Liga during season 2019 - 2020. 

